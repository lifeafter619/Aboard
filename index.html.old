<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Aboard - 简约白板</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/modules/time-display.css">
    <link rel="stylesheet" href="css/modules/feature-area.css">
    <link rel="stylesheet" href="css/modules/export.css">
    <link rel="stylesheet" href="css/modules/timer.css">
</head>
<body>
    <!-- Zoom controls in top right corner -->
    <div id="history-controls">
        <button id="export-btn-top" class="history-btn" title="导出画布">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        </button>
        <button id="zoom-out-btn" class="history-btn" title="缩小 (-)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="M21 21l-4.35-4.35"></path>
                <line x1="8" y1="11" x2="14" y2="11"></line>
            </svg>
        </button>
        <input type="text" id="zoom-input" class="zoom-input" value="100%" title="缩放比例 (输入百分比)">
        <button id="zoom-in-btn" class="history-btn" title="放大 (+)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="M21 21l-4.35-4.35"></path>
                <line x1="11" y1="8" x2="11" y2="14"></line>
                <line x1="8" y1="11" x2="14" y2="11"></line>
            </svg>
        </button>
        <button id="fullscreen-btn" class="history-btn" title="全屏 (F11)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
            </svg>
        </button>
    </div>

    <!-- Background canvas layer -->
    <canvas id="background-canvas"></canvas>
    
    <!-- Main drawing canvas -->
    <canvas id="canvas"></canvas>
    
    <!-- Eraser cursor overlay -->
    <div id="eraser-cursor" style="display: none;"></div>

    <!-- Dynamic configuration area (appears above toolbar) -->
    <div id="config-area">
        <!-- Close button for config panel -->
        <button id="config-close-btn" class="config-close-btn" title="关闭">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        
        <!-- Pen configuration -->
        <div id="pen-config" class="config-panel active">
            <div class="config-group">
                <label>笔触类型</label>
                <div class="button-size-options pen-type-grid">
                    <button class="pen-type-btn active" data-pen-type="normal">普通笔</button>
                    <button class="pen-type-btn" data-pen-type="pencil">铅笔</button>
                    <button class="pen-type-btn" data-pen-type="ballpoint">圆珠笔</button>
                    <button class="pen-type-btn" data-pen-type="fountain">钢笔</button>
                    <button class="pen-type-btn" data-pen-type="brush">毛笔</button>
                </div>
            </div>
            <div class="config-group">
                <label>颜色与粗细</label>
                <div class="color-picker-row">
                    <div class="color-picker-main">
                        <button class="color-btn active" data-color="#000000" style="background-color: #000000;" title="黑色"></button>
                        <button class="color-btn" data-color="#FF0000" style="background-color: #FF0000;" title="红色"></button>
                        <button class="color-btn" data-color="#0000FF" style="background-color: #0000FF;" title="蓝色"></button>
                        <button class="color-btn" data-color="#00FF00" style="background-color: #00FF00;" title="绿色"></button>
                    </div>
                    <div class="color-picker-main">
                        <button class="color-btn" data-color="#FFFF00" style="background-color: #FFFF00; border: 1px solid #ccc;" title="黄色"></button>
                        <button class="color-btn" data-color="#FF8800" style="background-color: #FF8800;" title="橙色"></button>
                        <button class="color-btn" data-color="#8800FF" style="background-color: #8800FF;" title="紫色"></button>
                        <button class="color-btn" data-color="#FFFFFF" style="background-color: #FFFFFF; border: 1px solid #ccc;" title="白色"></button>
                    </div>
                </div>
                <div class="color-and-size-row">
                    <label class="color-picker-icon-btn" for="custom-color-picker" title="取色器">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path>
                            <polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
                        </svg>
                        <input type="color" id="custom-color-picker" class="custom-color-picker-input" value="#000000">
                    </label>
                    <div class="pen-size-inline">
                        <label>粗细 <span id="pen-size-value">5</span>px</label>
                        <input type="range" id="pen-size-slider" min="1" max="50" value="5" class="slider slider-compact">
                    </div>
                </div>
            </div>
        </div>



        <!-- Eraser configuration -->
        <div id="eraser-config" class="config-panel">
            <div class="config-group">
                <label>形状</label>
                <div class="button-size-options eraser-shape-options">
                    <button class="eraser-shape-btn active" data-eraser-shape="circle">圆形</button>
                    <button class="eraser-shape-btn" data-eraser-shape="rectangle">方形</button>
                </div>
            </div>
            <div class="config-group">
                <label>橡皮擦大小 <span id="eraser-size-value">20</span>px</label>
                <input type="range" id="eraser-size-slider" min="10" max="50" value="20" class="slider">
            </div>
        </div>

        <!-- Background configuration -->
        <div id="background-config" class="config-panel">
            <div class="config-group config-group-compact">
                <label>背景颜色</label>
                <div class="color-picker-row">
                    <div class="color-picker-main">
                        <button class="color-btn active" data-bg-color="#ffffff" style="background-color: #ffffff; border: 1px solid #ccc;" title="白色"></button>
                        <button class="color-btn" data-bg-color="#f5f5f5" style="background-color: #f5f5f5; border: 1px solid #ccc;" title="浅灰"></button>
                        <button class="color-btn" data-bg-color="#fffef0" style="background-color: #fffef0; border: 1px solid #ccc;" title="米黄"></button>
                        <button class="color-btn" data-bg-color="#000000" style="background-color: #000000;" title="黑色"></button>
                    </div>
                    <div class="color-picker-main">
                        <button class="color-btn" data-bg-color="#2d5016" style="background-color: #2d5016;" title="黑板绿"></button>
                        <button class="color-btn" data-bg-color="#4a7c59" style="background-color: #4a7c59;" title="青绿色"></button>
                        <button class="color-btn" data-bg-color="#654321" style="background-color: #654321;" title="棕色"></button>
                        <button class="color-btn" data-bg-color="#8B4513" style="background-color: #8B4513;" title="深棕色"></button>
                    </div>
                </div>
                <label class="color-picker-icon-btn" for="custom-bg-color-picker" title="取色器" style="margin-top: 8px;">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path>
                        <polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
                    </svg>
                    <input type="color" id="custom-bg-color-picker" class="custom-color-picker-input" value="#ffffff">
                </label>
            </div>
            <div class="config-group config-group-compact">
                <label>背景图案</label>
                <div class="button-size-options pattern-grid-compact" id="pattern-grid">
                    <button class="pattern-option-btn active" data-pattern="blank">空白</button>
                    <button class="pattern-option-btn" data-pattern="dots">点阵</button>
                    <button class="pattern-option-btn" data-pattern="grid">方格</button>
                    <button class="pattern-option-btn" data-pattern="tianzige">田字格</button>
                    <button class="pattern-option-btn" data-pattern="english-lines">四线格</button>
                    <button class="pattern-option-btn" data-pattern="music-staff">五线谱</button>
                    <button class="pattern-option-btn" data-pattern="coordinate">坐标系</button>
                    <button class="pattern-option-btn" data-pattern="image" id="image-pattern-btn">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 2px;">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                        图片
                    </button>
                    <input type="file" id="bg-image-upload" accept="image/*" style="display: none;">
                </div>
                <div class="compact-sliders">
                    <div class="compact-slider-item" id="pattern-density-group" style="display: none;">
                        <label>密度 <span id="pattern-density-value">100</span>%</label>
                        <input type="range" id="pattern-density-slider" min="50" max="200" value="100" class="slider slider-compact">
                    </div>
                    <div class="compact-slider-item" id="image-size-group" style="display: none;">
                        <label>大小 <span id="bg-image-size-value">100</span>%</label>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <input type="range" id="bg-image-size-slider" min="10" max="200" value="100" class="slider slider-compact" style="flex: 1;">
                            <button id="adjust-bg-image-btn" class="icon-btn" title="调整图片位置和大小">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- More configuration -->
        <div id="more-config" class="config-panel">
            <div class="config-group">
                <label>更多功能</label>
                <p class="settings-hint" style="font-size: 12px; color: #666; margin-top: -4px;">其他工具和配置项</p>
            </div>
        </div>
    </div>

    <!-- Time Display Area (independent, draggable, with edge snapping) -->
    <div id="time-display-area">
        <!-- Close button for time display area -->
        <button id="time-display-area-close-btn" class="config-close-btn" title="关闭">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        
        <div class="config-group">
            <label>时间显示选项</label>
            <label class="checkbox-label">
                <input type="checkbox" id="show-date-checkbox-area">
                <span>显示日期</span>
            </label>
            <label class="checkbox-label" style="margin-top: 8px;">
                <input type="checkbox" id="show-time-checkbox-area">
                <span>显示时间</span>
            </label>
        </div>
    </div>

    <!-- Feature buttons area (independent, draggable, with edge snapping) -->
    <div id="feature-area" class="feature-area">
        <!-- Close button for feature panel -->
        <button id="feature-close-btn" class="config-close-btn" title="关闭">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        
        <div class="config-group">
            <label>小功能</label>
            <div class="more-features-grid">
                <button id="time-display-feature-btn" class="feature-btn" title="时间显示">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    <span>时间</span>
                </button>
                <button id="timer-feature-btn" class="feature-btn" title="计时器">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="13" r="8"></circle>
                        <path d="M12 9v4l2 2"></path>
                        <path d="M9 2h6"></path>
                        <path d="M12 2v2"></path>
                    </svg>
                    <span>计时</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Pagination controls (below zoom, only visible when not in infinite canvas mode) -->
    <div id="pagination-controls">
        <button id="prev-page-btn" class="page-nav-btn" title="上一页">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
        </button>
        <input type="number" id="page-input" class="page-input" value="1" min="1" title="输入页码跳转">
        <span id="page-total">/ 1</span>
        <button id="next-or-add-page-btn" class="page-nav-btn" title="下一页">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9 18 15 12 9 6"></polyline>
            </svg>
        </button>
    </div>

    <!-- Settings modal -->
    <div id="settings-modal" class="modal">
        <div class="modal-content settings-modal-content">
            <div class="modal-header">
                <h2>设置</h2>
                <button id="settings-close-btn" class="modal-close-btn" title="关闭">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            
            <!-- Settings layout with sidebar and content -->
            <div class="settings-layout">
                <!-- Settings sidebar with icons -->
                <div class="settings-sidebar">
                    <button class="settings-tab-icon active" data-tab="general" title="通用">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="3"></circle>
                            <path d="M12 1v6m0 6v6M5.6 5.6l4.2 4.2m4.2 4.2l4.2 4.2M1 12h6m6 0h6M5.6 18.4l4.2-4.2m4.2-4.2l4.2-4.2"></path>
                        </svg>
                        <span>通用</span>
                    </button>
                    <button class="settings-tab-icon" data-tab="display" title="显示">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                            <line x1="8" y1="21" x2="16" y2="21"></line>
                            <line x1="12" y1="17" x2="12" y2="21"></line>
                        </svg>
                        <span>显示</span>
                    </button>
                    <button class="settings-tab-icon" data-tab="canvas" title="画布">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <path d="M3 9h18M9 21V9"></path>
                        </svg>
                        <span>画布</span>
                    </button>
                    <button class="settings-tab-icon" data-tab="background" title="背景">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                        <span>背景</span>
                    </button>
                    <button class="settings-tab-icon" data-tab="about" title="关于">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        <span>关于</span>
                    </button>
                    <button class="settings-tab-icon" data-tab="announcement" title="公告">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                            <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                        </svg>
                        <span>公告</span>
                    </button>
                    <button class="settings-tab-icon" data-tab="more" title="更多">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="12" cy="5" r="1"></circle>
                            <circle cx="12" cy="19" r="1"></circle>
                        </svg>
                        <span>更多</span>
                    </button>
                </div>
                
                <!-- Settings content area -->
                <div class="settings-content">
                    <!-- General settings -->
                    <div id="general-settings" class="settings-tab-content active">
                        <h3>通用设置</h3>
                        <div class="settings-group">
                            <label>全局字体</label>
                            <p class="settings-hint">选择应用程序使用的字体</p>
                            <select id="global-font-select" class="format-select">
                                <option value="system">系统默认</option>
                                <option value="serif">宋体（衬线体）</option>
                                <option value="sans-serif">黑体（无衬线体）</option>
                                <option value="monospace">等宽字体</option>
                                <option value="cursive">手写体</option>
                                <option value="Microsoft YaHei">微软雅黑</option>
                                <option value="SimSun">宋体</option>
                                <option value="SimHei">黑体</option>
                                <option value="KaiTi">楷体</option>
                                <option value="FangSong">仿宋</option>
                            </select>
                        </div>
                        <div class="settings-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="edge-snap-checkbox" checked>
                                <span>启用边缘吸附</span>
                            </label>
                            <p class="settings-hint">拖动控制面板时自动吸附到屏幕边缘</p>
                        </div>
                        <div class="settings-group">
                            <label>控制按钮位置</label>
                            <p class="settings-hint">选择缩放和分页控件在屏幕上的显示位置</p>
                            <div class="button-size-options button-size-options-4">
                                <button class="position-option-btn" data-position="top-left">左上角</button>
                                <button class="position-option-btn active" data-position="top-right">右上角</button>
                                <button class="position-option-btn" data-position="bottom-left">左下角</button>
                                <button class="position-option-btn" data-position="bottom-right">右下角</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Display settings -->
                    <div id="display-settings" class="settings-tab-content">
                        <h3>显示设置</h3>
                        <div class="settings-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-zoom-controls-checkbox" checked>
                                <span>显示缩放控件</span>
                            </label>
                            <p class="settings-hint">勾选后，在画布上方显示缩放控件</p>
                        </div>
                        <div class="settings-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-fullscreen-btn-checkbox" checked>
                                <span>显示全屏按钮</span>
                            </label>
                            <p class="settings-hint">勾选后，在缩放控件旁显示全屏按钮</p>
                        </div>
                        <div class="settings-group">
                            <label>工具栏大小 <span id="toolbar-size-value">40</span>px</label>
                            <p class="settings-hint">调整底部工具栏的大小</p>
                            <input type="range" id="toolbar-size-slider" min="40" max="80" value="40" class="slider" step="5">
                        </div>
                        <div class="settings-group">
                            <label>属性栏大小 <span id="config-scale-value">100</span>%</label>
                            <p class="settings-hint">调整弹出具体属性面板的大小</p>
                            <input type="range" id="config-scale-slider" min="80" max="120" value="100" class="slider" step="10">
                        </div>
                        <div class="settings-group">
                            <label>主题色</label>
                            <p class="settings-hint">工具栏被选中时的颜色</p>
                            <div class="color-picker-row">
                                <div class="color-picker-main">
                                    <button class="color-btn active" data-theme-color="#007AFF" style="background-color: #007AFF;" title="蓝色（默认）"></button>
                                    <button class="color-btn" data-theme-color="#34C759" style="background-color: #34C759;" title="绿色"></button>
                                    <button class="color-btn" data-theme-color="#FF3B30" style="background-color: #FF3B30;" title="红色"></button>
                                    <button class="color-btn" data-theme-color="#FF9500" style="background-color: #FF9500;" title="橙色"></button>
                                </div>
                                <div class="color-picker-main">
                                    <button class="color-btn" data-theme-color="#AF52DE" style="background-color: #AF52DE;" title="紫色"></button>
                                    <button class="color-btn" data-theme-color="#FF2D55" style="background-color: #FF2D55;" title="粉色"></button>
                                    <button class="color-btn" data-theme-color="#5AC8FA" style="background-color: #5AC8FA;" title="青色"></button>
                                    <button class="color-btn" data-theme-color="#FFCC00" style="background-color: #FFCC00; border: 1px solid #ccc;" title="黄色"></button>
                                </div>
                            </div>
                            <label class="color-picker-icon-btn" for="custom-theme-color-picker" title="自定义颜色" style="margin-top: 8px;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path>
                                    <polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
                                </svg>
                                <input type="color" id="custom-theme-color-picker" class="custom-color-picker-input" value="#007AFF">
                            </label>
                        </div>
                    </div>
                    
                    <!-- Canvas settings -->
                    <div id="canvas-settings" class="settings-tab-content">
                        <h3>画布设置</h3>
                        <div class="settings-group">
                            <label>画布模式</label>
                            <p class="settings-hint">选择画布的显示模式</p>
                            <div class="button-size-options button-size-options-2">
                                <button class="canvas-mode-btn active" data-mode="infinite">无限画布</button>
                                <button class="canvas-mode-btn" data-mode="paginated">分页模式</button>
                            </div>
                        </div>
                        <div class="settings-group" id="canvas-size-settings" style="display: none;">
                            <label>画布尺寸</label>
                            <p class="settings-hint">选择预设尺寸或自定义画布比例和大小</p>
                            <div class="canvas-presets">
                                <button class="canvas-preset-btn" data-preset="A4-portrait">A4 竖向</button>
                                <button class="canvas-preset-btn" data-preset="A4-landscape">A4 横向</button>
                                <button class="canvas-preset-btn" data-preset="A3-portrait">A3 竖向</button>
                                <button class="canvas-preset-btn" data-preset="A3-landscape">A3 横向</button>
                                <button class="canvas-preset-btn" data-preset="B5-portrait">B5 竖向</button>
                                <button class="canvas-preset-btn" data-preset="B5-landscape">B5 横向</button>
                                <button class="canvas-preset-btn" data-preset="16:9">16:9 宽屏</button>
                                <button class="canvas-preset-btn" data-preset="4:3">4:3 标准</button>
                                <button class="canvas-preset-btn active" data-preset="custom">自定义</button>
                            </div>
                            <div class="canvas-custom-size" id="canvas-custom-size">
                                <div class="custom-size-row">
                                    <label>宽度</label>
                                    <input type="number" id="canvas-width-input" value="1920" min="300" max="4000" step="10">
                                    <span>px</span>
                                </div>
                                <div class="custom-size-row">
                                    <label>高度</label>
                                    <input type="number" id="canvas-height-input" value="1080" min="300" max="4000" step="10">
                                    <span>px</span>
                                </div>
                                <div class="custom-size-row">
                                    <label>比例</label>
                                    <select id="canvas-ratio-select">
                                        <option value="custom">自定义</option>
                                        <option value="16:9">16:9</option>
                                        <option value="4:3">4:3</option>
                                        <option value="1:1">1:1</option>
                                        <option value="3:4">3:4 (竖向)</option>
                                        <option value="9:16">9:16 (竖向)</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Background settings -->
                    <div id="background-settings" class="settings-tab-content">
                        <h3>背景设置</h3>
                        <div class="settings-group">
                            <label>背景透明度 <span id="bg-opacity-value">100</span>%</label>
                            <p class="settings-hint">调整背景的透明度,100%为完全不透明</p>
                            <input type="range" id="bg-opacity-slider" min="0" max="100" value="100" class="slider">
                        </div>
                        <div class="settings-group">
                            <label>图案透明度 <span id="pattern-intensity-value">50</span>%</label>
                            <p class="settings-hint">调整背景图案线条的明暗程度</p>
                            <input type="range" id="pattern-intensity-slider" min="10" max="200" value="50" class="slider">
                        </div>
                        <div class="settings-group">
                            <label>背景图案偏好</label>
                            <p class="settings-hint">选择在属性栏中显示的图案</p>
                            <div class="pattern-preferences">
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="blank" checked>
                                    <span>空白</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="dots" checked>
                                    <span>点阵</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="grid" checked>
                                    <span>方格</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="tianzige" checked>
                                    <span>田字格</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="english-lines" checked>
                                    <span>英语四线格</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="music-staff" checked>
                                    <span>五线谱</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="coordinate" checked>
                                    <span>坐标系</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="pattern-pref-checkbox" data-pattern="image" checked>
                                    <span>上传图片</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- About settings -->
                    <div id="about-settings" class="settings-tab-content">
                        <h3>关于 Aboard</h3>
                        <div class="about-info">
                            <div class="about-section">
                                <h4>项目简介</h4>
                                <p>Aboard 是一个简约的网页白板应用，专为教学和演示设计。</p>
                                <p>它提供了流畅的绘图体验和丰富的背景选项，让您的创意自由展现。</p>
                            </div>
                            
                            <div class="about-section">
                                <h4>主要功能</h4>
                                <ul>
                                    <li>多种笔触类型（普通笔、铅笔、圆珠笔、钢笔、毛笔）</li>
                                    <li>智能橡皮擦（支持圆形和方形）</li>
                                    <li>丰富的背景图案（点阵、方格、田字格、英语四线格等）</li>
                                    <li>可调节的图案密度和透明度</li>
                                    <li>无限画布和分页模式（支持A4、A3、B5等预设尺寸）</li>
                                    <li>自定义画布尺寸和比例</li>
                                    <li>可拖动的工具栏和属性面板（支持垂直布局）</li>
                                    <li>撤销/重做功能（支持最多50步）</li>
                                    <li>智能缩放（Ctrl+滚轮，缩放至鼠标位置）</li>
                                    <li>响应式界面，适配不同屏幕尺寸</li>
                                </ul>
                            </div>
                            
                            <div class="about-section">
                                <h4>技术栈</h4>
                                <p>HTML5 Canvas • Vanilla JavaScript • CSS3</p>
                            </div>
                            
                            <div class="about-section">
                                <h4>开源协议</h4>
                                <p>MIT License</p>
                            </div>
                            
                            <div class="about-section">
                                <h4>GitHub</h4>
                                <p>
                                    <a href="https://github.com/lifeafter619/Aboard" target="_blank" rel="noopener noreferrer">
                                        github.com/lifeafter619/Aboard
                                    </a>
                                </p>
                            </div>
                            
                            <div class="about-section">
                                <h4>版本</h4>
                                <p>v2.1.0</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Announcement settings -->
                    <div id="announcement-settings" class="settings-tab-content">
                        <h3>公告</h3>
                        <div class="announcement-info">
                            <div id="settings-announcement-content" class="settings-announcement-content"></div>
                        </div>
                    </div>
                    
                    <!-- More settings -->
                    <div id="more-settings" class="settings-tab-content">
                        <h3>更多设置</h3>
                        <div class="settings-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="show-time-display-checkbox">
                                <span>显示时间和日期</span>
                            </label>
                            <p class="settings-hint">在右上角显示当前时间和日期</p>
                        </div>
                        <div class="settings-group" id="time-display-settings" style="display: none;">
                            <label>显示选项</label>
                            <div class="button-size-options" style="grid-template-columns: 1fr 1fr 1fr;">
                                <button class="display-option-btn active" data-display-type="both">日期和时间</button>
                                <button class="display-option-btn" data-display-type="date-only">仅日期</button>
                                <button class="display-option-btn" data-display-type="time-only">仅时间</button>
                            </div>
                        </div>
                        <div class="settings-group" id="timezone-settings" style="display: none;">
                            <label>时区</label>
                            <p class="settings-hint">选择要显示的时区</p>
                            <select id="timezone-select" class="format-select">
                                <option value="Asia/Shanghai">中国 (UTC+8)</option>
                                <option value="America/New_York">纽约 (UTC-5/-4)</option>
                                <option value="America/Los_Angeles">洛杉矶 (UTC-8/-7)</option>
                                <option value="America/Chicago">芝加哥 (UTC-6/-5)</option>
                                <option value="Europe/London">伦敦 (UTC+0/+1)</option>
                                <option value="Europe/Paris">巴黎 (UTC+1/+2)</option>
                                <option value="Europe/Berlin">柏林 (UTC+1/+2)</option>
                                <option value="Asia/Tokyo">东京 (UTC+9)</option>
                                <option value="Asia/Seoul">首尔 (UTC+9)</option>
                                <option value="Asia/Hong_Kong">香港 (UTC+8)</option>
                                <option value="Asia/Singapore">新加坡 (UTC+8)</option>
                                <option value="Asia/Dubai">迪拜 (UTC+4)</option>
                                <option value="Australia/Sydney">悉尼 (UTC+10/+11)</option>
                                <option value="Pacific/Auckland">奥克兰 (UTC+12/+13)</option>
                                <option value="UTC">UTC (协调世界时)</option>
                            </select>
                        </div>
                        <div class="settings-group" id="time-format-settings" style="display: none;">
                            <label>时间格式</label>
                            <p class="settings-hint">选择时间的显示格式</p>
                            <select id="time-format-select" class="format-select">
                                <option value="12h">12小时制 (上午/下午)</option>
                                <option value="24h">24小时制</option>
                            </select>
                        </div>
                        <div class="settings-group" id="date-format-settings" style="display: none;">
                            <label>日期格式</label>
                            <p class="settings-hint">选择日期的显示格式</p>
                            <select id="date-format-select" class="format-select">
                                <option value="yyyy-mm-dd">年-月-日 (2024-01-01)</option>
                                <option value="mm-dd-yyyy">月-日-年 (01-01-2024)</option>
                                <option value="dd-mm-yyyy">日-月-年 (01-01-2024)</option>
                                <option value="chinese">中文 (2024年1月1日)</option>
                            </select>
                        </div>
                        <div class="settings-group" id="time-color-settings" style="display: none;">
                            <label>颜色设置</label>
                            <p class="settings-hint">设置时间显示的字体和背景颜色</p>
                            <div style="display: flex; gap: 16px; flex-wrap: wrap;">
                                <div style="flex: 1; min-width: 200px;">
                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 8px;">字体颜色</label>
                                    <div class="color-picker-row">
                                        <div class="color-picker-main">
                                            <button class="color-btn active" data-time-color="#000000" style="background-color: #000000;" title="黑色"></button>
                                            <button class="color-btn" data-time-color="#FFFFFF" style="background-color: #FFFFFF; border: 1px solid #ccc;" title="白色"></button>
                                            <button class="color-btn" data-time-color="#007AFF" style="background-color: #007AFF;" title="蓝色"></button>
                                            <button class="color-btn" data-time-color="#FF0000" style="background-color: #FF0000;" title="红色"></button>
                                        </div>
                                        <div class="color-picker-main">
                                            <button class="color-btn" data-time-color="#00FF00" style="background-color: #00FF00;" title="绿色"></button>
                                            <button class="color-btn" data-time-color="#FFFF00" style="background-color: #FFFF00; border: 1px solid #ccc;" title="黄色"></button>
                                            <button class="color-btn" data-time-color="#FF8800" style="background-color: #FF8800;" title="橙色"></button>
                                            <button class="color-btn" data-time-color="#8800FF" style="background-color: #8800FF;" title="紫色"></button>
                                        </div>
                                    </div>
                                    <label class="color-picker-icon-btn" for="custom-time-color-picker" title="自定义颜色" style="margin-top: 8px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path>
                                            <polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
                                        </svg>
                                        <input type="color" id="custom-time-color-picker" class="custom-color-picker-input" value="#000000">
                                    </label>
                                </div>
                                <div style="flex: 1; min-width: 200px;">
                                    <label style="font-size: 11px; color: #666; display: block; margin-bottom: 8px;">背景颜色</label>
                                    <div class="color-picker-row">
                                        <div class="color-picker-main">
                                            <button class="color-btn" data-time-bg-color="transparent" style="background: linear-gradient(135deg, #fff 45%, #f00 45%, #f00 55%, #fff 55%); border: 1px solid #ccc;" title="透明"></button>
                                            <button class="color-btn active" data-time-bg-color="#FFFFFF" style="background-color: #FFFFFF; border: 1px solid #ccc;" title="白色"></button>
                                            <button class="color-btn" data-time-bg-color="#000000" style="background-color: #000000;" title="黑色"></button>
                                            <button class="color-btn" data-time-bg-color="#007AFF" style="background-color: #007AFF;" title="蓝色"></button>
                                        </div>
                                        <div class="color-picker-main">
                                            <button class="color-btn" data-time-bg-color="#FF0000" style="background-color: #FF0000;" title="红色"></button>
                                            <button class="color-btn" data-time-bg-color="#00FF00" style="background-color: #00FF00;" title="绿色"></button>
                                            <button class="color-btn" data-time-bg-color="#FFFF00" style="background-color: #FFFF00; border: 1px solid #ccc;" title="黄色"></button>
                                            <button class="color-btn" data-time-bg-color="#8800FF" style="background-color: #8800FF;" title="紫色"></button>
                                        </div>
                                    </div>
                                    <label class="color-picker-icon-btn" for="custom-time-bg-color-picker" title="自定义颜色" style="margin-top: 8px;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path>
                                            <polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
                                        </svg>
                                        <input type="color" id="custom-time-bg-color-picker" class="custom-color-picker-input" value="#FFFFFF">
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="settings-group" id="time-font-size-settings" style="display: none;">
                            <label>字体大小 <span id="time-font-size-value">16</span>px</label>
                            <p class="settings-hint">调整时间显示的字体大小</p>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="range" id="time-font-size-slider" min="12" max="48" value="16" class="slider" style="flex: 1;">
                                <input type="number" id="time-font-size-input" min="12" max="48" value="16" class="size-input">
                            </div>
                        </div>
                        <div class="settings-group" id="time-opacity-settings" style="display: none;">
                            <label>透明度 <span id="time-opacity-value">100</span>%</label>
                            <p class="settings-hint">调整时间显示的透明度</p>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="range" id="time-opacity-slider" min="10" max="100" value="100" class="slider" style="flex: 1;">
                                <input type="number" id="time-opacity-input" min="10" max="100" value="100" class="size-input">
                            </div>
                        </div>
                        <div class="settings-group" id="time-fullscreen-settings" style="display: none;">
                            <label>全屏模式</label>
                            <p class="settings-hint">选择如何触发时间全屏显示</p>
                            <div class="button-size-options" style="grid-template-columns: 1fr 1fr 1fr;">
                                <button class="fullscreen-mode-btn" data-mode="disabled">关闭</button>
                                <button class="fullscreen-mode-btn" data-mode="single">单击</button>
                                <button class="fullscreen-mode-btn active" data-mode="double">双击</button>
                            </div>
                        </div>
                        <div class="settings-group" id="time-fullscreen-font-size-settings" style="display: none;">
                            <label>全屏字体大小 <span id="time-fullscreen-font-size-value">15</span>%</label>
                            <p class="settings-hint">调整全屏时间显示的字体大小，范围10%-85%</p>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="range" id="time-fullscreen-font-size-slider" min="10" max="85" value="15" class="slider" style="flex: 1;">
                                <input type="number" id="time-fullscreen-font-size-input" min="10" max="85" value="15" class="size-input">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Confirm modal for clear action -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content confirm-modal-content">
            <div class="modal-header">
                <h2>确认清空</h2>
            </div>
            <div class="modal-body">
                <p class="confirm-message">确定要清空画布吗？此操作无法撤销。</p>
                <div class="confirm-buttons">
                    <button id="confirm-cancel-btn" class="confirm-btn cancel-btn">取消</button>
                    <button id="confirm-ok-btn" class="confirm-btn ok-btn">确定</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Announcement modal -->
    <div id="announcement-modal" class="modal">
        <div class="modal-content announcement-modal-content">
            <div class="modal-header">
                <h2 id="announcement-title">公告</h2>
            </div>
            <div class="modal-body">
                <div id="announcement-content" class="announcement-content"></div>
                <div class="announcement-buttons">
                    <button id="announcement-ok-btn" class="announcement-btn ok-btn">确定</button>
                    <button id="announcement-no-show-btn" class="announcement-btn no-show-btn">不再弹出</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Timer Alert Modal (Warning Level) -->
    <div id="timer-alert-modal" class="modal">
        <div class="modal-content confirm-modal-content">
            <div class="modal-header">
                <h2>⚠️ 提示</h2>
            </div>
            <div class="modal-body">
                <p class="confirm-message" id="timer-alert-message">请设置倒计时时间</p>
                <div class="confirm-buttons">
                    <button id="timer-alert-ok-btn" class="confirm-btn ok-btn">确定</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom toolbar -->
    <div id="toolbar">
        <button id="undo-btn" class="tool-btn" data-tool="undo" title="撤销 (Ctrl+Z)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 7v6h6"></path>
                <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13"></path>
            </svg>
            <span>撤销</span>
        </button>
        <button id="redo-btn" class="tool-btn" data-tool="redo" title="重做 (Ctrl+Y)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 7v6h-6"></path>
                <path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7"></path>
            </svg>
            <span>重做</span>
        </button>
        <button id="pen-btn" class="tool-btn active" data-tool="pen" title="笔">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
                <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
                <path d="M2 2l7.586 7.586"></path>
                <circle cx="11" cy="11" r="2"></circle>
            </svg>
            <span>笔</span>
        </button>
        <button id="pan-btn" class="tool-btn" data-tool="pan" title="移动画布 (Shift+拖动)">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 11V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v0"></path>
                <path d="M14 10V4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v2"></path>
                <path d="M10 10.5V6a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v8"></path>
                <path d="M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15"></path>
            </svg>
            <span>移动</span>
        </button>
        <button id="eraser-btn" class="tool-btn" data-tool="eraser" title="橡皮擦">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 20H7L3 16 12 7 17 12"></path>
                <path d="M7 20l5-5"></path>
            </svg>
            <span>橡皮</span>
        </button>
        <button id="background-btn" class="tool-btn" data-tool="background" title="背景">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
            </svg>
            <span>背景</span>
        </button>
        <button id="clear-btn" class="tool-btn" data-tool="clear" title="清空画布">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"></path>
            </svg>
            <span>清空</span>
        </button>
        <button id="more-btn" class="tool-btn" data-tool="more" title="更多">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="1"></circle>
                <circle cx="12" cy="5" r="1"></circle>
                <circle cx="12" cy="19" r="1"></circle>
            </svg>
            <span>更多</span>
        </button>
        <button id="settings-btn" class="tool-btn" data-tool="settings" title="设置">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6M5.6 5.6l4.2 4.2m4.2 4.2l4.2 4.2M1 12h6m6 0h6M5.6 18.4l4.2-4.2m4.2-4.2l4.2-4.2"></path>
            </svg>
            <span>设置</span>
        </button>
    </div>

    <!-- Time Display (for More feature) -->
    <div id="time-display" style="display: none;"></div>

    <!-- Fullscreen Time Display Modal -->
    <div id="time-fullscreen-modal" class="time-fullscreen-modal">
        <button id="time-fullscreen-close-btn" class="time-fullscreen-close-btn" title="关闭全屏">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        <div id="time-fullscreen-content"></div>
        <div class="time-fullscreen-controls">
            <div class="time-fullscreen-slider-label">字体大小调节 (10%-85%)</div>
            <input type="range" id="time-fullscreen-font-slider" class="time-fullscreen-slider" min="10" max="85" value="15" step="0.5">
        </div>
    </div>

    <!-- Fullscreen Timer Display Modal -->
    <div id="timer-fullscreen-modal" class="timer-fullscreen-modal">
        <button id="timer-fullscreen-close-btn" class="timer-fullscreen-close-btn" title="关闭全屏">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        </button>
        <div id="timer-fullscreen-content"></div>
        <div class="timer-fullscreen-controls">
            <div class="timer-fullscreen-slider-label">字体大小调节 (10%-85%)</div>
            <input type="range" id="timer-fullscreen-font-slider" class="timer-fullscreen-slider" min="10" max="85" value="15" step="0.5">
        </div>
    </div>

    <!-- Timer Settings Modal -->
    <div id="timer-settings-modal">
        <div class="timer-modal-content">
            <div class="timer-modal-header">
                <h2>计时器设置</h2>
                <button id="timer-settings-close-btn" class="modal-close-btn" title="关闭">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="timer-modal-body">
                <!-- Timer Mode Selection -->
                <div class="timer-mode-group">
                    <label>选择模式</label>
                    <div class="timer-mode-buttons">
                        <button class="timer-mode-btn active" data-mode="stopwatch">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="13" r="8"></circle>
                                <path d="M12 9v4l2 2"></path>
                                <path d="M9 2h6"></path>
                            </svg>
                            正计时
                        </button>
                        <button class="timer-mode-btn" data-mode="countdown">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="13" r="8"></circle>
                                <path d="M12 9v4l2 2"></path>
                                <path d="M9 2h6"></path>
                                <path d="M16 6l-4 4"></path>
                            </svg>
                            倒计时
                        </button>
                    </div>
                </div>
                
                <!-- Timer Title Input -->
                <div class="timer-input-group">
                    <label for="timer-title-input">计时器标题（可选）</label>
                    <input type="text" id="timer-title-input" class="timer-title-input" placeholder="例如：课堂演讲、考试时间等" maxlength="50">
                </div>
                
                <!-- Time Input -->
                <div class="timer-input-group">
                    <label id="timer-time-label">设置时间</label>
                    <div class="time-inputs">
                        <div class="time-input-field">
                            <label>小时</label>
                            <input type="number" id="timer-hours" min="0" max="23" value="0">
                        </div>
                        <div class="time-input-field">
                            <label>分钟</label>
                            <input type="number" id="timer-minutes" min="0" max="59" value="0">
                        </div>
                        <div class="time-input-field">
                            <label>秒</label>
                            <input type="number" id="timer-seconds" min="0" max="59" value="0">
                        </div>
                    </div>
                </div>
                
                <!-- Sound Settings (only for countdown) -->
                <div class="timer-sound-group disabled">
                    <div class="sound-checkbox">
                        <input type="checkbox" id="timer-sound-checkbox">
                        <label for="timer-sound-checkbox">倒计时结束时播放提示音</label>
                    </div>
                    
                    <div class="sound-settings-content" id="sound-settings-content" style="display: none;">
                        <div class="sound-presets sound-presets-grid">
                            <button class="sound-preset-btn active" data-sound="class-bell" data-url="sounds/class-bell.MP3">
                                开始铃声(10s)
                            </button>
                            <button class="sound-preset-btn" data-sound="exam-end" data-url="sounds/exam-end.MP3">
                                考试结束(4s)
                            </button>
                            <button class="sound-preset-btn" data-sound="gentle-alarm" data-url="sounds/gentle-alarm.MP3">
                                柔和(17s)
                            </button>
                            <button class="sound-preset-btn" data-sound="digital-beep" data-url="sounds/digital-beep.MP3">
                                结束铃声(4s)
                            </button>
                        </div>
                        
                        <div class="sound-loop-settings">
                            <div class="sound-checkbox">
                                <input type="checkbox" id="timer-loop-checkbox">
                                <label for="timer-loop-checkbox">循环播放</label>
                            </div>
                            <div class="sound-loop-count" id="sound-loop-count-group" style="display: none;">
                                <label for="timer-loop-count">循环次数</label>
                                <input type="number" id="timer-loop-count" min="1" max="100" value="3" class="loop-count-input">
                            </div>
                        </div>
                        
                        <div class="sound-upload-group">
                            <label for="timer-sound-upload" class="sound-upload-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="17 8 12 3 7 8"></polyline>
                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                </svg>
                                上传自定义音频
                            </label>
                            <input type="file" id="timer-sound-upload" accept="audio/*" multiple style="display: none;">
                        </div>
                        
                        <div id="custom-sounds-list" class="sound-presets" style="margin-top: 10px;"></div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="timer-action-buttons">
                    <button class="timer-action-btn timer-cancel-btn" id="timer-cancel-btn">取消</button>
                    <button class="timer-action-btn timer-start-btn" id="timer-start-btn">开始</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Timer Display Widget -->
    <div id="timer-display">
        <div class="timer-display-header">
            <div class="timer-display-mode">正计时</div>
            <button class="timer-close-btn" id="timer-display-close-btn" title="关闭">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="timer-display-time">00:00:00</div>
        <div class="timer-display-controls">
            <button class="timer-control-btn" id="timer-play-pause-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="6" y="4" width="4" height="16"></rect>
                    <rect x="14" y="4" width="4" height="16"></rect>
                </svg>
                暂停
            </button>
            <button class="timer-control-btn" id="timer-reset-btn">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                    <path d="M21 3v5h-5"></path>
                    <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                    <path d="M3 21v-5h5"></path>
                </svg>
                重置
            </button>
        </div>
    </div>

    <script src="js/drawing.js"></script>
    <script src="js/history.js"></script>
    <script src="js/background.js"></script>
    <script src="js/image-controls.js"></script>
    <script src="js/stroke-controls.js"></script>
    <script src="js/collapsible.js"></script>
    <script src="js/time-display.js"></script>
    <script src="js/modules/time-display-controls.js"></script>
    <script src="js/modules/timer.js"></script>
    <script src="js/settings.js"></script>
    <script src="js/announcement.js"></script>
    <script src="js/export.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
